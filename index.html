<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>GalaxyWeb Functional</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    background: #0a0e17;
    color: #fff;
    font-family: 'Poppins', sans-serif;
    overflow-x: hidden;
  }

  /* Header */
  .top-bar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 90px;
    background: rgba(16, 23, 36, 0.85);
    padding: 0 40px;
    backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    position: sticky;
    top: 0;
    z-index: 100;
  }

  .logo-title {
    display: flex;
    align-items: center;
    gap: 15px;
    font-size: 1.8rem;
    font-weight: bold;
    font-family: 'Montserrat', sans-serif;
    color: #fff;
  }

  .logo-title img {
    height: 90px;
    filter: drop-shadow(0 0 8px rgba(97, 218, 251, 0.7));
  }

  .nav-buttons { 
    display: flex; 
    align-items: center; 
    gap: 30px; 
    font-size: 1.1rem; 
    position: relative; 
  }

  .nav-btn,
  .profile-btn { 
    background: none; 
    border: none; 
    color: #e0e0e0; 
    cursor: pointer; 
    font-size: 1rem; 
    position: relative;
    font-family: 'Poppins', sans-serif;
    font-weight: 500;
    padding: 8px 12px;
    border-radius: 6px;
    transition: all 0.3s ease;
  }

  .nav-btn:hover, .profile-btn:hover { 
    color: #64c2ff;
    background: rgba(255, 255, 255, 0.05);
  }

  .profile-btn img {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #64c2ff;
  }

  .dropdown-content { 
    display: none; 
    position: absolute; 
    right: 0; 
    background: rgba(29, 35, 54, 0.95); 
    min-width: 160px; 
    border-radius: 8px; 
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2); 
    top: 50px; 
    z-index: 1000;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    overflow: hidden;
  }

  .dropdown-content a { 
    color: #e0e0e0; 
    padding: 12px 16px; 
    text-decoration: none; 
    display: block; 
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    transition: all 0.2s ease;
  }

  .dropdown-content a:last-child { border-bottom: none; }

  .dropdown-content a:hover { 
    background: rgba(100, 194, 255, 0.1);
    color: #64c2ff;
  }

  .nav-buttons .more-options:hover .dropdown-content,
  .nav-buttons .profile-btn.show-menu + .dropdown-content { 
    display: block; 
  }

  /* Banner */
  .banner { 
    height: 500px; 
    background: #161b28; 
    margin: 0; 
    padding: 0; 
    overflow: hidden;
    position: relative;
  }

  .banner::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 100px;
    background: linear-gradient(to top, #0a0e17, transparent);
    z-index: 2;
  }

  .banner img { 
    width: 100%; 
    height: 100%; 
    object-fit: cover; 
    display: block; 
  }

  /* Description */
  .desc-section { 
    height: 433px; 
    background: linear-gradient(135deg, #161b28 0%, #1c2236 100%);
    display: flex; 
    align-items: center; 
    justify-content: space-between; 
    padding: 0 50px;
    position: relative;
  }

  .desc-text { 
    flex: 2; 
    display: flex; 
    flex-direction: column; 
    justify-content: center; 
    text-align: left; 
    gap: 28px; 
  }

  .desc-text h1 { 
    font-size: 2.4rem; 
    font-family: 'Montserrat', sans-serif;
    background: linear-gradient(90deg, #fff 0%, #64c2ff 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .desc-text p { 
    font-size: 1.2rem; 
    max-width: 560px; 
    white-space: pre-line; 
    line-height: 1.6;
    color: #d0d0d0;
  }

  .desc-img { 
    flex: 1; 
    display: flex; 
    align-items: flex-end; 
    justify-content: flex-end; 
    height: 100%; 
    padding-right: 40px;
  }

  .desc-img img {
    max-width: 150%;
    max-height: 550px;
    object-fit: contain;
    filter: drop-shadow(0 5px 25px rgba(32, 39, 70, 0.6)) brightness(1.1);
    transform: translateX(20px);
  }

  /* Cards */
  .cards-wrap {
    position: relative;
    width: 100%;
    overflow-x: hidden;
    background: none;
    margin: 0;
    padding: 40px 0;
  }

  .cards-section {
    display: flex;
    gap: 32px;
    justify-content: center;
    align-items: stretch;
    height: 500px;
    padding: 0 40px;
    background: linear-gradient(rgba(10, 14, 23, 0.9), rgba(10, 14, 23, 0.9)), 
                url('https://dl.dropboxusercontent.com/scl/fi/702xkjz07yxrq8mr6trzx/192f66_590271f07f9c499c92f0912416c55cbe-mv2.png?rlkey=0vnahm1klu5qf4da6gzmwzmjg&st=pkbwfnoo&dl=0');
    background-size: cover;
    background-position: center center;
    background-repeat: no-repeat;
    width: 100%;
    box-sizing: border-box;
  }

  .card { 
    background: linear-gradient(145deg, rgba(24,31,43,0.95) 0%, rgba(32,40,57,0.95) 100%); 
    border-radius: 16px; 
    margin: 20px 10px; 
    min-width: 280px; 
    height: 95%; 
    display: flex; 
    flex-direction: column; 
    color: #fff; 
    overflow: hidden; 
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
  }

  .card:hover {
    transform: translateY(-8px);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
  }

  .card img { 
    height: 180px; 
    width: 100%; 
    object-fit: cover; 
    border-top-left-radius: 16px; 
    border-top-right-radius: 16px; 
    margin-bottom: 12px; 
  }

  .card-content { 
    padding: 20px; 
    flex-grow: 1; 
    text-align: center; 
  }

  .card-content h3 { 
    margin: 0 0 12px 0; 
    font-family: 'Montserrat', sans-serif;
    font-size: 1.4rem;
    color: #fff;
  }

  .card-content p { 
    font-size: 1rem; 
    white-space: pre-line; 
    line-height: 1.5;
    color: #d0d0d0;
  }

  .card-footer { 
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    font-size: 1rem; 
    opacity: 0.92; 
    padding: 0 20px 20px 20px; 
  }

  .card-footer .views, .card-footer .likes { 
    display: flex; 
    align-items: center; 
    gap: 7px; 
  }

  .card-footer .likes { 
    cursor: pointer; 
    transition: all 0.2s ease;
  }

  .card-footer .likes:hover {
    color: #ff5b5b;
  }

  .card-footer .likes .fa-heart {
    transition: all 0.2s ease;
  }

  .card-footer .likes:hover .fa-heart {
    transform: scale(1.2);
  }

  .card-footer .likes .fa-solid {
    color: #ff5b5b;
  }

  /* Skeleton Loading */
  .skeleton {
    background: linear-gradient(90deg, #1a2232 25%, #232e44 50%, #1a2232 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
    border-radius: 8px;
  }

  @keyframes loading {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
  }

  .skeleton-card {
    background: rgba(32,40,57,0.95);
    border-radius: 16px;
    margin: 20px 10px;
    min-width: 280px;
    height: 95%;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  .skeleton-img {
    height: 180px;
    width: 100%;
    border-top-left-radius: 16px;
    border-top-right-radius: 16px;
    margin-bottom: 12px;
  }

  .skeleton-text {
    height: 20px;
    margin: 10px 20px;
    border-radius: 4px;
  }

  .skeleton-text.short {
    width: 60%;
  }

  .skeleton-footer {
    display: flex;
    justify-content: space-between;
    margin: 20px;
  }

  .skeleton-icon {
    width: 80px;
    height: 20px;
    border-radius: 4px;
  }

  /* Collaborators */
  .collaborators-wrap { 
    background: linear-gradient(to right, #1a2232 0%, #252d42 100%); 
    padding: 50px 60px; 
    min-height: 280px; 
    display: flex; 
    flex-direction: column; 
    align-items: flex-start; 
    justify-content: flex-start; 
  }

  .collaborators-title { 
    font-size: 1.9rem; 
    color: #fab84f; 
    margin-bottom: 28px; 
    font-weight: 700; 
    letter-spacing: 1px; 
    font-family: 'Montserrat', sans-serif;
  }

  .collaborators-section { 
    width: 100%; 
    display: grid; 
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); 
    gap: 36px; 
    justify-items: center; 
    align-items: center; 
    margin-top: 10px; 
  }

  .collaborator-logo-box { 
    background: linear-gradient(135deg, #192135 0%, #2e3c5c 100%); 
    box-shadow: 0 5px 20px rgba(23, 29, 44, 0.4); 
    border-radius: 20px; 
    width: 140px; 
    height: 140px; 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    justify-content: center; 
    padding: 16px; 
    transition: all 0.3s ease;
    border: 2px solid rgba(233, 196, 106, 0.3);
    cursor: pointer;
  }

  .collaborator-logo-box:hover { 
    box-shadow: 0 0 25px rgba(250, 184, 79, 0.5);
    transform: translateY(-5px);
    border-color: #e9c46a;
  }

  .collaborator-logo-box img { 
    width: 80px; 
    height: 80px; 
    object-fit: contain; 
    border-radius: 14px; 
    background: rgba(36, 48, 73, 0.5);
    margin-bottom: 10px; 
    padding: 8px;
  }

  .collaborator-label { 
    font-size: 0.9rem; 
    color: #fff; 
    text-align: center; 
    margin-top: 4px; 
    white-space: nowrap; 
    font-weight: 500;
  }

  /* Footer */
  .footer {
    min-height: 320px;
    background: linear-gradient(90deg, #131825 0%, #1a2232 50%, #20293d 100%);
    color: #fff;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 40px;
    align-items: start;
    padding: 50px;
    border-top: 1px solid rgba(255, 255, 255, 0.05);
    box-sizing: border-box;
  }

  .footer-col {
    padding: 0 15px;
    display: flex;
    flex-direction: column;
    height: 100%;
  }

  .footer-about-title {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 15px;
    color: #fab84f;
    font-family: 'Montserrat', sans-serif;
  }

  .footer-about-text {
    font-size: 1rem;
    color: #d0d0d0;
    margin-bottom: 20px;
    line-height: 1.6;
  }

  .footer-social {
    margin-top: auto;
    display: flex;
    gap: 18px;
  }

  .footer-social a { 
    color: #aaa; 
    font-size: 1.8rem; 
    text-decoration: none; 
    transition: all 0.3s ease; 
  }

  .footer-social a:hover { 
    color: #64c2ff; 
    transform: translateY(-3px);
  }

  .footer-links-col {
    display: flex;
    flex-direction: column;
  }

  .footer-links-col a {
    font-size: 1.1rem;
    color: #d0d0d0;
    text-decoration: none;
    margin-bottom: 14px;
    font-weight: 500;
    transition: all 0.2s ease;
    display: block;
  }

  .footer-links-col a:hover { 
    color: #fab84f; 
    transform: translateX(5px);
  }

  .footer-contact-row {
    margin-bottom: 12px;
    font-size: 1rem;
    display: flex; 
    align-items: center; 
    gap: 10px;
    color: #d0d0d0;
  }

  .footer-contact-label {
    color: #fab84f; 
    margin-right: 4px; 
    font-weight: 500;
    font-size: 1rem;
    min-width: 110px;
  }

  .footer-contact {
    margin-top: 15px; 
    font-size: 1.02rem;
    color: #fff;
  }

  .footer-contact-icon {
    font-size: 1.2rem; 
    vertical-align: middle; 
    color: #64c2ff; 
    margin-right: 10px;
    width: 20px;
    text-align: center;
  }

  .address-section {
    margin-top: 20px;
    padding: 20px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
  }

  .address-title {
    font-size: 1.2rem;
    color: #fab84f;
    margin-bottom: 10px;
    font-weight: 600;
  }

  .address-text {
    font-size: 1rem;
    color: #d0d0d0;
    line-height: 1.6;
  }

  @media (max-width: 900px) {
    .footer {
      grid-template-columns: 1fr;
      padding: 34px 20px;
      gap: 24px;
    }

    .footer-col { 
      padding: 12px 5px; 
    }

    .desc-section {
      flex-direction: column;
      height: auto;
      padding: 40px 30px;
      text-align: center;
    }

    .desc-text {
      text-align: center;
      align-items: center;
      margin-bottom: 30px;
    }

    .desc-img {
      justify-content: center;
      padding-right: 0;
    }

    .desc-img img {
      transform: none;
      max-width: 100%;
    }

    .cards-section {
      flex-direction: column;
      height: auto;
      align-items: center;
    }

    .card {
      width: 90%;
      margin-bottom: 30px;
    }

    .collaborators-section {
      grid-template-columns: repeat(2, 1fr);
    }
  }
</style>
</head>
<body>
  <!-- Top Section -->
  <div class="top-bar">
    <div class="logo-title">
      <img
        src="https://dl.dropboxusercontent.com/scl/fi/ulfs6ygkeyvr4mar8bkuz/galaxwbewh.png?rlkey=jq9buj80ny6et6jfbfpiuf14l&st=lwkqobqi&dl=0"
        height="46"
        alt="Logo"
      />
      GalaxyWeb
    </div>
    <div class="nav-buttons">
      <button class="nav-btn">Home</button>
      <button class="nav-btn">Team Galaxy</button>
      <div class="more-options">
        <button class="nav-btn">More ▼</button>
        <div class="dropdown-content">
          <a href="#">Blog</a>
          <a href="#">Posts</a>
          <a href="#">Portfolio</a>
        </div>
      </div>
      <button id="profileBtn" class="profile-btn"><i class="fa-solid fa-user"></i></button>
      <div id="profileMenu" class="dropdown-content" style="right: 30px; display:none;">
        <a href="#" id="profileLink">Profile</a>
        <a href="#" id="logoutLink">Logout</a>
      </div>
    </div>
  </div>

  <!-- Banner Section -->
  <div class="banner">
    <img
      src="https://dl.dropboxusercontent.com/scl/fi/xrm9oz497flxbgeg2ftbh/192f66_67551a1745204b0abb6b170d8aabdea5-mv2.jpg?rlkey=9os8s4wyc1f2mc5xclveeds9t&st=h763i6y8&dl=0"
      alt="Galaxy Banner"
    />
  </div>

  <!-- Description Section -->
  <div class="desc-section">
    <div class="desc-text">
      <h1>Welcome to GalaxyWeb</h1>
      <p>
        Welcome to Galaxy — a united space where competition, creativity, and community meet. Here you’ll find the latest news from our Team Galaxy clan, shop official merch to show your pride, explore stunning visuals from Galaxy Design, and connect with fellow players and creators through our blog. Whether you’re here to fight alongside us, wear the Galaxy name, commission a design, or simply be part of an active, welcoming community, this is your home among the stars.
      </p>
    </div>
    <div class="desc-img">
      <img
        src="https://dl.dropboxusercontent.com/scl/fi/ulfs6ygkeyvr4mar8bkuz/galaxwbewh.png?rlkey=jq9buj80ny6et6jfbfpiuf14l&st=lwkqobqi&dl=0"
        alt="Random PNG"
      />
    </div>
  </div>

  <!-- Cards Section -->
  <div class="cards-wrap">
    <div id="cardsContainer" class="cards-section">
      <!-- Skeleton cards while loading -->
      <div class="skeleton-card">
        <div class="skeleton skeleton-img"></div>
        <div class="skeleton skeleton-text" style="width: 70%;"></div>
        <div class="skeleton skeleton-text" style="width: 90%;"></div>
        <div class="skeleton skeleton-text" style="width: 80%;"></div>
        <div class="skeleton-footer">
          <div class="skeleton skeleton-icon"></div>
          <div class="skeleton skeleton-icon"></div>
        </div>
      </div>
      <div class="skeleton-card">
        <div class="skeleton skeleton-img"></div>
        <div class="skeleton skeleton-text" style="width: 70%;"></div>
        <div class="skeleton skeleton-text" style="width: 90%;"></div>
        <div class="skeleton skeleton-text" style="width: 80%;"></div>
        <div class="skeleton-footer">
          <div class="skeleton skeleton-icon"></div>
          <div class="skeleton skeleton-icon"></div>
        </div>
      </div>
      <div class="skeleton-card">
        <div class="skeleton skeleton-img"></div>
        <div class="skeleton skeleton-text" style="width: 70%;"></div>
        <div class="skeleton skeleton-text" style="width: 90%;"></div>
        <div class="skeleton skeleton-text" style="width: 80%;"></div>
        <div class="skeleton-footer">
          <div class="skeleton skeleton-icon"></div>
          <div class="skeleton skeleton-icon"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Collaborators Section -->
  <div class="collaborators-wrap">
    <div class="collaborators-title">Our Collaborators</div>
    <div class="collaborators-section">
      <div class="collaborator-logo-box" data-url="https://www.google.com">
        <img
          src="https://dl.dropboxusercontent.com/scl/fi/tgfz0bdpfs8r7emm6xqdo/8699158.jpg?rlkey=769ayec8274jsb4c1ms2ojpeh&st=gwaz95i2&dl=0"
          alt="I"
        />
        <div class="collaborator-label">I</div>
      </div>
      <div class="collaborator-logo-box" data-url="https://www.google.com">
        <img
          src="https://dl.dropboxusercontent.com/scl/fi/ih79814t1c2od22jmdbfw/8699161.jpg?rlkey=vxrzhkc3id3njeli1xza6gitc&st=rfqt55u3&dl=0"
          alt="Made"
        />
        <div class="collaborator-label">rpowkq</div>
      </div>
      <div class="collaborator-logo-box" data-url="https://www.google.com">
        <img
          src="https://dl.dropboxusercontent.com/scl/fi/orf6i07ebo705jnq5tkx7/1744702095638.png?rlkey=6jvqg2lrucvw5c8vst71rg5kl&st=r19g59l4&dl=0"
          alt="It!"
        />
        <div class="collaborator-label">ojqw powkeqw</div>
      </div>
    </div>
  </div>

  <!-- Footer Section -->
  <footer class="footer">
    <div class="footer-col">
      <div class="footer-about-title">About TeamGalaxy</div>
      <div class="footer-about-text">TeamGalaxy is an innovative gaming and creative community, united by passion and the spirit of collaboration. We host tournaments, share design ideas, and grow talents together — join now to explore the Galaxy!</div>
      <div class="footer-social">
        <a href="https://twitter.com" title="Twitter"><i class="fab fa-twitter"></i></a>
        <a href="https://facebook.com" title="Facebook"><i class="fab fa-facebook"></i></a>
        <a href="https://instagram.com" title="Instagram"><i class="fab fa-instagram"></i></a>
        <a href="https://youtube.com" title="YouTube"><i class="fab fa-youtube"></i></a>
        <a href="https://discord.com" title="Discord"><i class="fab fa-discord"></i></a>
      </div>
    </div>
    <div class="footer-col">
      <div class="footer-links-col">
        <a href="#">Privacy Policy</a>
        <a href="#">Terms & Conditions</a>
        <a href="#">Other</a>
      </div>
      <div class="address-section">
        <div class="address-title">Our Address</div>
        <div class="address-text">
          44 Galaxy St, Universe City, WebLand<br>
          Phone: +91-9876543210<br>
          Email: support@gmail.com<br>
          Working Hours: Mon-Sat 10am - 10pm
        </div>
      </div>
    </div>
  </footer>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-check-compat.js"></script>
  <!-- reCaptcha -->
  <script src="https://www.google.com/recaptcha/api.js?render=6Ld395IrAAAAAIvG4gyf0vUJeI_jKOsI9XVn0jUx"></script>

  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyBV7Jg0BVzeCNQW9oiIiNItnejUsjj2DhA",
      authDomain: "squadvertex2007.firebaseapp.com",
      projectId: "squadvertex2007",
      storageBucket: "squadvertex2007.appspot.com",
      messagingSenderId: "168905083514",
      appId: "1:168905083514:web:c8bbe2ce9f87800a0f09c3",
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

    // Activate App Check
    try {
      const appCheckProvider = new firebase.appCheck.ReCaptchaV3Provider(
        "6Ld395IrAAAAAIvG4gyf0vUJeI_jKOsI9XVn0jUx"
      );
      firebase.appCheck().activate(appCheckProvider, true);
      console.log(
        "App Check (compat) activated — reCaptcha v3 provider attached."
      );
    } catch (e) {
      console.warn("App Check activation failed (compat):", e);
    }

    const auth = firebase.auth();
    const db = firebase.firestore();

    const profileBtn = document.getElementById("profileBtn");
    const profileMenu = document.getElementById("profileMenu");

    // Make collaborator boxes clickable
    document.querySelectorAll('.collaborator-logo-box').forEach(box => {
      box.addEventListener('click', () => {
        const url = box.getAttribute('data-url');
        if (url) {
          window.open(url, '_blank');
        }
      });
    });

    profileBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      // If user is not signed in, trigger sign in
      if (!currentUser) {
        signIn();
        return;
      }
      // If signed in, show the menu
      profileMenu.style.display =
        profileMenu.style.display === "block" ? "none" : "block";
    });

    // Close profile menu if clicked outside
    window.addEventListener("click", () => {
      profileMenu.style.display = "none";
    });

    // Sign-In Function (Google OAuth)
    async function signIn() {
      const provider = new firebase.auth.GoogleAuthProvider();
      try {
        await auth.signInWithPopup(provider);
      } catch (error) {
        alert("Sign-in failed: " + error.message);
      }
    }

    // Sign-Out Function
    async function signOut() {
      try {
        await auth.signOut();
      } catch (error) {
        alert("Sign-out failed: " + error.message);
      }
    }

    // Track current user
    let currentUser = null;
    auth.onAuthStateChanged((user) => {
      currentUser = user;
      updateProfileButton();
      loadCards();
    });

    // Update Profile Button (show sign in or profile photo)
    function updateProfileButton() {
      if (currentUser) {
        if (currentUser.photoURL) {
          profileBtn.innerHTML = `<img src="${currentUser.photoURL}" alt="Profile">`;
        } else {
          profileBtn.innerHTML = '<i class="fa-solid fa-user"></i>';
        }
        // Logout link inside the menu
        document.getElementById("logoutLink").onclick = async (e) => {
          e.preventDefault();
          await signOut();
        };
        // Profile link placeholder
        document.getElementById("profileLink").onclick = (e) => {
          e.preventDefault();
          alert("Profile clicked - implement profile page.");
        };
      } else {
        profileBtn.innerHTML = "Sign In";
        // Remove any existing click handler to prevent multiple bindings
        profileBtn.onclick = (e) => {
          e.stopPropagation();
          signIn();
        };
      }
    }

    // Increment views once per session per card for visitor
    let visitedCards =
      JSON.parse(sessionStorage.getItem("visitedCards")) || [];

    // Load cards from Firestore
    async function loadCards() {
      const cardsContainer = document.getElementById("cardsContainer");

      // Show skeleton loading
      cardsContainer.innerHTML = `
        <div class="skeleton-card">
          <div class="skeleton skeleton-img"></div>
          <div class="skeleton skeleton-text" style="width: 70%;"></div>
          <div class="skeleton skeleton-text" style="width: 90%;"></div>
          <div class="skeleton skeleton-text" style="width: 80%;"></div>
          <div class="skeleton-footer">
            <div class="skeleton skeleton-icon"></div>
            <div class="skeleton skeleton-icon"></div>
          </div>
        </div>
        <div class="skeleton-card">
          <div class="skeleton skeleton-img"></div>
          <div class="skeleton skeleton-text" style="width: 70%;"></div>
          <div class="skeleton skeleton-text" style="width: 90%;"></div>
          <div class="skeleton skeleton-text" style="width: 80%;"></div>
          <div class="skeleton-footer">
            <div class="skeleton skeleton-icon"></div>
            <div class="skeleton skeleton-icon"></div>
          </div>
        </div>
        <div class="skeleton-card">
          <div class="skeleton skeleton-img"></div>
          <div class="skeleton skeleton-text" style="width: 70%;"></div>
          <div class="skeleton skeleton-text" style="width: 90%;"></div>
          <div class="skeleton skeleton-text" style="width: 80%;"></div>
          <div class="skeleton-footer">
            <div class="skeleton skeleton-icon"></div>
            <div class="skeleton skeleton-icon"></div>
          </div>
        </div>
      `;

      try {
        const snapshot = await db
          .collection("cards")
          .orderBy("publishedAt", "desc")
          .limit(3)
          .get();

        cardsContainer.innerHTML = "";

        snapshot.docs.forEach((doc) => {
          const data = doc.data();
          const id = doc.id;

          // Increment views once if not visited this session
          if (!visitedCards.includes(id)) {
            db.collection("cards").doc(id).update({
              views: firebase.firestore.FieldValue.increment(1),
            });
            visitedCards.push(id);
            sessionStorage.setItem(
              "visitedCards",
              JSON.stringify(visitedCards)
            );
          }

          const card = createCard(
            id,
            data.heading,
            data.description,
            data.views || 0,
            data.likes || 0,
            data.imageUrl || ""
          );
          cardsContainer.appendChild(card);
        });
      } catch (error) {
        console.error("Error loading cards:", error);
        cardsContainer.innerHTML = "<p>Error loading content. Please try again later.</p>";
      }
    }

    // Create a card element
    function createCard(id, heading, description, views, likes, imageUrl) {
      const card = document.createElement("div");
      card.className = "card";
      card.tabIndex = 0;
      card.setAttribute("role", "button");

      card.addEventListener("click", () => {
        window.location.href = `https://www.squadvertex.great-site.net/cards?id=${id}`;
      });
      card.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          card.click();
        }
      });

      // Card image
      const img = document.createElement("img");
      img.src = imageUrl || "https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=500&q=80";
      img.alt = heading;
      card.appendChild(img);

      // Content container
      const content = document.createElement("div");
      content.className = "card-content";

      const h3 = document.createElement("h3");
      h3.textContent = heading || "uw gzbskzj haosjj";

      const p = document.createElement("p");
      p.textContent = description || "whhaj wnus hcs hx w whhaj hcs woqw kjqw qowq pwq.";

      content.appendChild(h3);
      content.appendChild(p);
      card.appendChild(content);

      // Footer container (views and likes)
      const footer = document.createElement("div");
      footer.className = "card-footer";

      // Views
      const viewsSpan = document.createElement("span");
      viewsSpan.className = "views";
      viewsSpan.innerHTML = `<i class="fa-regular fa-eye"></i> ${views}`;
      footer.appendChild(viewsSpan);

      // Likes (if logged in only)
      const likesSpan = document.createElement("span");
      likesSpan.className = "likes";
      likesSpan.style.cursor = currentUser ? "pointer" : "not-allowed";
      likesSpan.title = currentUser ? "Like" : "Sign In to Like";
      likesSpan.innerHTML = `<i class="fa-regular fa-heart"></i> ${likes}`;

      likesSpan.addEventListener("click", async (e) => {
        e.stopPropagation();
        if (!currentUser) {
          alert("Please sign in to like.");
          return;
        }
        // Check if user has liked already
        const likeDoc = await db
          .collection("cards")
          .doc(id)
          .collection("likes")
          .doc(currentUser.uid)
          .get();

        if (likeDoc.exists) {
          alert("You have already liked this card.");
          return;
        }
        try {
          // Add like doc
          await db.collection("cards").doc(id).collection("likes").doc(currentUser.uid).set({
            likedAt: firebase.firestore.FieldValue.serverTimestamp(),
          });
          // Increment likes count
          await db.collection("cards").doc(id).update({
            likes: firebase.firestore.FieldValue.increment(1),
          });
          // Update UI
          const newLikes = likes + 1;
          likesSpan.innerHTML = `<i class="fa-solid fa-heart" style="color: #ff5b5b;"></i> ${newLikes}`;
          likesSpan.style.cursor = "default";
          likesSpan.title = "You liked this";
        } catch (err) {
          alert("Error liking card: " + err.message);
        }
      });

      footer.appendChild(likesSpan);
      card.appendChild(footer);

      return card;
    }

    // Initialize
    updateProfileButton();
    loadCards();
  </script>
</body>
</html>